---

copyright:
  years: 2017, 2018, 2019

lastupdated: "2019-05-17"

keywords: resource, access, role, role-based, authorization, policy, access group, resource group, permission, assign, administrator, operator, editor, viewer, user, team, scenario, manage, create, IAM

subcollection: vpc-on-classic

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:note: .note}
{:important: .important}
{:download: .download}
{:DomainName: data-hd-keyref="DomainName"}

# VPC リソースに対するユーザー許可の管理
{: #managing-user-permissions-for-vpc-resources}

{{site.data.keyword.cloud}} 仮想プライベート・クラウドでは、役割ベースのアクセス制御が使用されます。これによって、アカウント管理者が、VPC リソースに対するユーザーのアクセスを制御できます。

IBM Cloud VPC での役割ベースのアクセス制御の使用方法、IAM の役割とアクセス・ポリシーを VPC で使用する方法について詳しくは、[VPC リソースに対する役割ベースのアクセス権限の割り当て](/docs/vpc-on-classic?topic=vpc-on-classic-assigning-role-based-access-to-vpc-resources)を参照してください。

この資料では、アカウントの管理者がユーザーをアカウントに追加し、適切な許可をユーザーに付与することで、[VPC のインフラストラクチャー・リソース](/docs/vpc-on-classic?topic=vpc-on-classic-about-vpc-infrastructure-resources)を管理する方法について説明します。 この資料では、VPC 管理者によくある次の 2 つのシナリオについて説明しています。

* **シンプルなアクセス権限のシナリオ:** ユーザーが VPC インフラストラクチャー・リソース (仮想プライベート・クラウドを含む) を作成して使用できるように、ユーザーにアクセス・ポリシーを割り当てます。

* **チームのアクセス権限のシナリオ:** 2 つの別々のチームが各チームに割り当てられた VPC リソースを作成して使用できるように、リソース・グループとアクセス・ポリシーをセットアップします。

VPC 用の IAM アクセス・ポリシーに対する変更は、有効になるまでに最大で 10 分かかることがあります。
{: note}

## シンプルなアクセス権限のシナリオ
{: #simple-access-scenario}

このシナリオでは、個々のユーザーをセットアップするための基本的な手順について説明します。 ここでは、アカウントに新規ユーザーを招待するケースと、既存のユーザーの許可を変更するケースの 2 つを対象にします。

### VPC リソースを作成または管理するために新規ユーザーを招待する
{: #inviting-a-new-user-to-create-or-manage-vpc-resources}

IBM Cloud ユーザーをアカウントに招待し、そのユーザーが VPC リソースを表示、作成、更新できるように、そのユーザーに `VPC インフラストラクチャー`に対するアクセス権限を付与します。このセクションでは、IAM の大まかな手順について簡単に説明します。 詳細については、この資料の最後あたりにある『**関連リンク**』セクションのリンク先にあります。

IAM で VPC のサービスやリソースにユーザーを招待するための基本的な手順は次のとおりです。

1. IBM Cloud コンソールの [IAM ユーザー UI ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン")](https://{DomainName}/iam#/users){: new_window} にナビゲートします。
2. **「ユーザー」**ページで、**「ユーザーの招待」**をクリックします。
3. **「ユーザー」**セクションの**「ユーザーの招待」**ページで、招待するユーザーの E メール・アドレスを**「E メール・アドレス」**フィールドに入力します。
4. **「アクセス」**セクションで**「サービス」**を展開してから、以下のタスクを実行します。
  * **「アクセス権限の割り当て」**リストから**「リソース」**を選択します。
  * **「サービス」**リストから**「VPC インフラストラクチャー」**を選択します。
  * ユーザーに割り当てるプラットフォーム・アクセス役割を選択します。 これは、**管理者**、**エディター**、**オペレーター**、または**ビューアー**にすることができます。
  * **「ユーザーの招待」**をクリックします。

### VPC リソースを管理するための許可を既存のユーザーに付与する
{: #giving-an-existing-user-permission-to-manage-vpc-resources}

このシナリオでは、アカウントの既存のユーザーに VPC リソースを編集するための許可を付与する基本的な手順について説明します。

以下の手順では、2 つの IAM ポリシーを作成します。 ユーザーが VPC インフラストラクチャー・リソースを作成して使用するためには、この両方のポリシーが必要です。すべてのリソースが、アカウントのデフォルトのリソース・グループ内に存在している必要があります。

1. IBM Cloud コンソールの [IAM ユーザー UI ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン")](https://{DomainName}/iam#/users){: new_window} にナビゲートします。
2. 権限を有効にするユーザーを選択します。
3. **「アクセス・ポリシー」**タブで、**「アクセス権限の割り当て」**を選択します。
4. **「リソース・グループ内のアクセス権限の割り当て」**を選択します。
5. アカウントのデフォルトのリソース・グループを選択します。
6. **「リソース・グループへのアクセス権限の割り当て」**オプションが**「ビューアー」**に設定されたままであることを確認します。
7. 正しいサービスを割り当てるために、**「VPC インフラストラクチャー」**を選択します。
8. **「リソース・タイプ」**の値が**「すべてのリソース・タイプ」**に設定されていることを確認します。
9. **「エディター」**役割を選択します。
10. **「割り当て」**をクリックします。

これで、このユーザーは、アカウントのデフォルトのリソース・グループ内に VPC リソースを作成して使用できるようになりました。 最初のポリシー (ステップ 1 から 6) では、アカウントのデフォルトのリソース・グループを表示することをユーザーに許可しました。2 つ目のポリシー (ステップ 7 から 10) では、VPC インフラストラクチャー・リソースに対する**エディター**の役割がユーザーに割り当てられましたが、アクセス権限はアカウントのデフォルトのリソース・グループに含まれているリソースに制限されます。

{: tip}

## ユーザーの許可の表示
{: #viewing-your-user-s-permissions}

ポリシーは、ユーザーの**「アクセス・ポリシー」**タブに表示されます。

次の各 CLI コマンドを使用して、ユーザーに割り当てられているリソース・グループの許可をポリシー別またはアクセス・グループ別に表示できます。

**ポリシー別**
```
ibmcloud iam user-policies <username>
```
**アクセス・グループ別**
```
ibmcloud iam access-groups -u <username>
```

VPC 用の IAM アクセス・ポリシーに対する変更は、有効になるまでに最大で 10 分かかることがあります。
{: note}

## チームのアクセス権限のシナリオ
{: #team-access-scenario}

このシナリオでは、チームごとに別の VPC リソースに対するアクセス権限を持つように、アカウント管理者が権限を割り当てる方法について説明します。 この例では、_リソース・グループ_ を使用して、2 つのチームに別々のリソース・アクセスをセットアップします。 この例の目的のために、チーム間ではリソースを共有しません。

この例では、チームごとに別の VPC リソースに対するアクセス権限を与えるために、リソース・グループを作成し、アクセス・グループを作成し、適切なポリシーを割り当てるというプロセスについて説明します。

2 つの異なるプロジェクト・チームを、2 つの別々の仮想プライベート・クラウドを使用するようにセットアップするという状況を想像してください。 各チームが自分のチームの VPC リソース (だけ) にアクセスできるようにチーム・メンバーにアクセス権限を割り当てます。

* 1 つ目のチームはテスト・チームです。 `test_vpcs` というリソース・グループの VPC へのアクセス権限を、このチームに割り当てることにします。
* 2 つ目のチームは実動チームです。 このチームには、`production_vpcs` というリソース・グループの VPC へのアクセス権限を割り当てます。

ここで使用する方法では、任意の数のチームに別々の VPC リソースを割り当てることができます。 ただし、すべてのリソースにはこのアカウントの同じ VPC 割り当て量が使用されます。 割り当て量および制限について詳しくは、[VPC 割り当て量](/docs/vpc-on-classic?topic=vpc-on-classic-quotas#quotas)を参照してください。
{: tip}

### 手順 1: リソース・グループを作成する
{: #step-1-create-resource-groups}

アカウント管理者は、デフォルトでリソース・グループを新規作成できます。 他のユーザーは、**すべてのアカウント管理サービス**に対する**エディター**役割を事前に割り当てられていれば、リソース・グループを作成することを許可されます。

最初のタスクは、各チームの VPC リソースを入れるリソース・グループを作成することです。

1. `test_team` というリソース・グループを作成します。  
2. `production_team` というリソース・グループを作成します。  

リソース・グループの作成方法について詳しくは、[リソース・グループの管理](/docs/resources?topic=resources-rgs)を参照してください。

### 手順 2: アクセス・グループを作成する
{: #step-2-create-access-groups}

リソースのアクセス権限は、個々のユーザーまたはユーザーのグループに割り当てることができます。 同じアクセス許可を持つユーザーのグループを、_アクセス・グループ_ と呼びます。 このシナリオでは、特定のタイプの VPC アクセス権限を必要とするチーム・メンバーのグループごとにアクセス・グループを 1 つ作成し、合計で 4 つの固有のアクセス・グループを作成します。

**タスク:** `test_team_manage_vpcs`、`test_team_view_vpcs`、`production_team_manage_vpcs`、`production_team_view_vpcs` という 4 つのアクセス・グループを作成します。

アクセス・グループの作成方法については、[アクセス・グループの作成](/docs/iam?topic=iam-groups#create_ag)を参照してください。

### 手順 3: 前の手順で作成したアクセス・グループに IAM ポリシーを追加する
{: #step-3-add-iam-policies-to-the-access-groups-you-just-created}

`test_team` アクセス・グループで VPC リソースを管理 (作成、更新、および削除) できるように、必要な VPC アクセス・ポリシーを追加します。  

1. IBM Cloud コンソールの [IAM グループ UI ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン")](https://{DomainName}/iam#/groups){: new_window} にナビゲートします。
2. 目的のアクセス・グループ (`test_team_manage_vpcs` で始まる) を選択します。
3. **「アクセス・ポリシー」**タブで、**「アクセス権限の割り当て」**をクリックします。
4. **「リソース・グループ内のアクセス権限の割り当て」**を選択します。
5. 目的のリソース・グループ (`test_team` で始まる) を選択します
6. **「リソース・グループへのアクセス権限の割り当て」**が**「ビューアー」**に設定されたままであることを確認します。
7. サービス**「VPC インフラストラクチャー」**を選択します。
8. **「リソース・タイプ」**が**「すべてのリソース・タイプ」**に設定されたままであることを確認します。
9. **「エディター」**役割を選択します。
10. **「割り当て」**を選択します。

上記の手順では、`test_team` リソース・グループに対する**ビューアー**のアクセス権限も割り当てています。 `test_team` リソース・グループ内のリソースを更新、作成、および削除するには、ビューアー・アクセス権限が必要です。

{: tip}

残りの 3 つのアクセス・グループについて、上記の手順を繰り返します。 以下のタスクを実行して、各アクセス・グループを各リソース・グループに対応付けます。

* `test_team` リソース・グループ内の VPC インフラストラクチャーのリソースに対する**ビューアー**役割を、`test_team_view_vpcs` アクセス・グループに割り当てます。
* `production_team` リソース・グループ内の VPC インフラストラクチャーのリソースに対する**エディター**役割を、`production_team_manage_vpcs` アクセス・グループに割り当てます。
* `production_team` リソース・グループ内の VPC インフラストラクチャーのリソースに対する**ビューアー**役割を、`production_team_view_vpcs` アクセス・グループに割り当てます。

VPC リソースに対する**エディター**のアクセス権限を持つユーザーは、それらのリソースを表示することもできます。 **エディター**と**ビューアー**の両方のアクセス・グループにメンバーを追加する必要はありません。

#### ビューアー・アクセス権限のセットアップ
{: #setting-up-viewer-access)

VPC インフラストラクチャーの`浮動 IP` リソースは、アカウントのデフォルトのリソース・グループ内に作成されます。したがって、`浮動 IP` を管理する必要があるユーザーには、アカウントのデフォルトのリソース・グループに対する**ビューアー**・アクセス権限が必要になります。
{: tip}

この**ビューアー**・アクセス権限を作成する方法を以下に示します。

1. IBM Cloud コンソールの [IAM グループ UI ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン")](https://{DomainName}/iam#/groups){: new_window} にナビゲートします。
2. 目的のアクセス・グループ (`test_team_manage_vpcs` で始まる) を選択します。
3. **「アクセス・ポリシー」**タブで、**「アクセス権限の割り当て」**をクリックします。
4. **「アカウント管理サービスへのアクセス権限の割り当て」**を選択します。
7. **「すべてのアカウント管理サービス」**を選択します。
9. **「ビューアー」**役割を選択します。
10. **「割り当て」**を選択します。

上記の手順を繰り返して、**「すべてのアカウント管理サービス」**に対する**「ビューアー」**役割を `production_team_manage_vpcs` アクセス・グループに割り当てます。

### 手順 4: アクセス・グループにユーザーを追加する
{: #step-4-add-users-to-the-access-groups}

これで、適切なアクセス・グループにチーム・メンバー (ユーザー) を割り当てられるようになりました。 以下の手順に従って、テスト・チームの各メンバーを、テスト・チームの VPC の管理を許可するアクセス・グループに追加します。

1. IBM Cloud コンソールの [IAM グループ UI ![外部リンク・アイコン](../icons/launch-glyph.svg "外部リンク・アイコン")](https://{DomainName}/iam#/groups){: new_window} にナビゲートします。
2. 目的のアクセス・グループ (`test_team_manage_vpcs` で始まる) を選択します。
3. **「ユーザー」**タブで、**「ユーザーの追加」**をクリックします。
4. アクセス・グループに追加するユーザーをすべて選択します。
5. **「グループに追加」**をクリックします。

上記の手順を繰り返して、次のタスクを実行します。
* `test_team_view_vpcs` アクセス・グループに必要なユーザーを割り当てます。
* `production_team_manage_vpcs` アクセス・グループに必要なユーザーを割り当てます。
* `production_team_view_vpcs` アクセス・グループに必要なユーザーを割り当てます。

管理アクセス権限を持っているユーザーには、VPC リソースに対する**ビューアー**・アクセス権限を割り当てる必要はありません。
{: tip}

## 次のステップ
{: #permissions-next-steps}

これで、例の 2 つのチームが、VPC を使用するようにセットアップされました。 この時点で、アクセス・グループ `test_team_manage_vpcs` と `production_team_manage_vpcs` のメンバーは、割り当てられたリソース・グループ内に VPC を作成できます。


## 関連リンク
{: #permissions-related-links}

* [ID およびアクセス権限の管理](/docs/iam?topic=iam-getstarted)
* [ユーザーおよびアクセス権限の管理](/docs/iam?topic=iam-iamuserinv)
* [IAM とは](/docs/iam?topic=iam-iamoverview)
